# Game Tutorial
（中文版本请查看下面的部分）
## Level 1 — Phishing Emails & Web Scanning

### Background
Level 1 is a phishing-email + web-scanning scenario. The protagonist malware aims to trick the Bmail administrator into revealing credentials to log into the backend.

**Email phishing** is when an attacker impersonates a trusted sender (colleague, partner, bank, etc.) and uses email to lure recipients into clicking malicious links, opening attachments, or entering sensitive information such as usernames and passwords, thereby stealing data or delivering malware.

Common types include:
- **Link phishing**: embedding a forged URL in the message body to direct the user to a phishing site
- **Attachment phishing**: sending attachments that contain malicious macros or executables that run when opened
- **Clone phishing**: copying a legitimate email's content and injecting malicious elements, leveraging the recipient's trust in the original message
- **QR-code phishing**: placing a fake QR code in an email or message that directs users to a malicious site when scanned

**Real-world examples**: In the 2016 John Podesta phishing incident, attackers impersonated Google’s security team to steal the Democratic chairman’s credentials, influencing the U.S. election. Another high-profile case was the 2020 Twitter Bitcoin scam, where attackers used phishing to gain internal employee access and hijack celebrity accounts to post cryptocurrency scams.

**How to spot phishing emails**:
- Inspect the sender address: hover to reveal the actual email address
- Watch for urgent language: phrases like "click immediately" or "your account will be frozen"
- Check the URL: hover to reveal the real destination
- Avoid opening suspicious attachments unless the source is verified

In the game, Level 1 demonstrates link phishing. People tend to accept information that aligns with their interests or prior knowledge. Attackers exploit this psychology — for example, using a "cat pageant" link to prompt a quick click without careful inspection.

Clues about the protagonist in Level 1 can be found in browsing history and the recycle bin, which is a reminder that seemingly hidden places may contain sensitive information.

**Web scanning** uses crawlers or dedicated security tools to systematically fetch pages, enumerate paths, and detect vulnerabilities on a target site. It’s often used to discover hidden admin interfaces, unauthenticated APIs, and sensitive files — the game calls these "backend links."

The technique shown in the game is **directory/file enumeration**: trying common admin paths (e.g. `/admin/`, `/manager/`, `/login.php`) using wordlists or bruteforce. This is a classic approach and remains common in the real world. Mitigations include avoiding predictable paths, providing uniform error responses, and using a Web Application Firewall (WAF) to rate-limit requests.

**Defensive measures**:
- Use randomly generated admin path names
- Enforce IP whitelisting for backend access
- Deploy a Web Application Firewall (WAF)
- Perform regular security scans and monitoring

The main challenge in this level is assembling the Send-Email parameters: `OriginalLink` denotes the template link to use for the phishing page, and `Subject` should be chosen to pique the target’s interest.

### Solution
1. Gather email addresses from photos in the recycle bin
2. Retrieve cat pageant search data from history
3. Find `www.bmail.com` in link logs
4. Use WebScan to discover the backend link
5. Send a phishing email with Send-Email to obtain the password
6. Log into the backend using the discovered link

## Level 2 — SQL Injection & VPN Backdoor

### Background
Level 2 features an email system; directory/file enumeration still helps find HTTP interfaces to backend databases, and WebScan uncovers the corresponding database endpoints.

**SQL injection** occurs when a web application concatenates user-supplied input into SQL statements without proper sanitization or parameterization, allowing an attacker to inject SQL keywords (e.g. `SELECT`, `UNION`, `OR`, `--`) so the database executes queries it otherwise wouldn't.

Login forms, search boxes, URL parameters, and cookies are all potential injection points. For example, if the backend builds a query like `SELECT * FROM users WHERE name='${input}'`, an attacker can submit `' OR 1=1--` in `${input}` to make the condition always true, thereby bypassing authentication or retrieving all records.

SQL injection was first widely documented in 1998 (Phrack #54) and became a major web-security issue as PHP+MySQL and ASP+SQL Server proliferated in the 1999–2005 era. Even in 2025, SQL injection remains a standard item in penetration tests and audits; thousands of sites still suffer from improper protections. Parameterized queries, strict input validation, least privilege, and error concealment, together with regular pentests, can largely mitigate this risk.

**Severity levels for SQL injection**:
- **Low**: can read only public data
- **Medium**: can read sensitive data or modify records
- **High**: can execute system commands or gain full server control
- **Critical**: can delete databases or implant persistent backdoors

This level also uses phishing as in Level 1, but the goal shifts to injecting a backdoor — dropping script or binary payloads into the victim’s browser/system and achieving a network callback for remote control.

**Fingerprinting**: phishing pages may collect browser fingerprints (User-Agent, Canvas/WebGL traits, fonts, plugins, etc.) and store them, enabling the attacker to mimic a target's fingerprint to better impersonate the victim.

**C2 server (Command and Control)**: a remote server used by attackers to control compromised hosts. Backdoors typically poll the C2 for instructions and exfiltrate stolen data. C2 infrastructure can be:
- dedicated servers: attacker-rented VPS or cloud instances
- compromised hosts: otherwise legitimate servers that have been taken over
- P2P networks: decentralized control that is harder to shut down

Backdoors often tunnel through **VPNs** as a C2 channel because VPN encryption lets malicious traffic blend with legitimate traffic, making detection harder. The game’s **DPI (Deep Packet Inspection)** inspects not only headers (IP, ports) but also payload contents to identify protocols, patterns, and keywords.

**Real-world example**: The 2017 WannaCry ransomware spread using the EternalBlue exploit; its C2 infrastructure was hosted in North Korea. Attackers attempted to hide communications using various covert channels, contributing to a global outbreak.

**OpenVPN** is an open-source VPN implementation supporting UDP or TCP, TLS-based encryption (e.g. AES-256-CBC, AES-256-GCM), and multiple authentication modes (certificates, username/password, mutual TLS). It operates in TUN (routing) or TAP (bridging) modes.

**Backdoor persistence techniques**:
- **Startup registry entries**: adding keys in Windows registry to launch on boot
- **Scheduled tasks**: creating scheduled jobs that run at intervals
- **Service installation**: registering the backdoor as a system service
- **Kernel modules**: installing kernel-level backdoors that are hard to detect and remove

We note that Bmail stores passwords in plaintext, which is highly dangerous. In real systems, passwords should be processed with dedicated hashing algorithms combined with unique salts (so identical passwords do not yield identical hashes). Hashing compresses the password into a fixed-size "fingerprint" that is practically irreversible. Many additional protections are standard in modern systems; consult security references for details.

### Solution
1. Use WebScan to discover target endpoints
2. Use SQL injection to retrieve email records and key data
3. Inject the backdoor payload
4. Establish a VPN connection via Vpn-Tool
5. Use Remote-Connect to access the target system remotely

## Level 3 — Man-in-the-Middle & Firewall Bypass

### Background
Level 3 shifts from domain names to direct IPs and includes port targeting. In practice, you must first probe which ports on the target IP are open and which services (e.g. web servers) respond to HTTP requests.

This level introduces **MITM (Man-in-the-Middle)** attacks, where an attacker inserts themselves between two communicating parties (typically client ↔ server), intercepting, modifying, or forging network traffic while both sides believe they are communicating directly.

**MITM implementation techniques**:
- **ARP spoofing**: forging ARP responses on a LAN to redirect traffic
- **DNS spoofing**: altering DNS resolution to point victims to fake sites
- **BGP hijacking**: intercepting routes at the internet routing level
- **SSL stripping**: downgrading HTTPS to HTTP
- **Malicious proxies**: tricking clients to use an attacker-controlled proxy

**How ARP spoofing works**:
ARP (Address Resolution Protocol) maps IP addresses to MAC addresses. When host A wants to talk to host B, it broadcasts an ARP request for B’s MAC. An attacker C can send a forged ARP reply claiming to be B’s MAC, causing A to send packets destined for B to the attacker instead.

**Real-world examples**: In 2018 an attack on Marriott hotel Wi‑Fi used ARP spoofing to intercept guests' traffic and steal credit card and login data. Another example is the 2019 Capital One breach, where cloud misconfiguration and MITM techniques contributed to the theft of data for millions of users.

**MITM defensive measures**:
- Use HTTPS and HSTS (HTTP Strict Transport Security)
- Deploy ARP monitoring and detection
- Use VPNs to encrypt traffic
- Implement certificate pinning
- Keep systems patched and up to date

The attack code in the level exploits a **buffer overflow in an authentication module**, meaning a component responsible for login/credential checks has a memory buffer vulnerability. Overwriting the buffer leads to control-flow corruption.

**Buffer overflow mechanics**:
Programs allocate fixed-size memory for variables. When input exceeds that size, excess data overwrites adjacent memory. A carefully crafted input can overwrite return addresses, alter variables, or ultimately execute arbitrary code.

With ARP spoofing redirecting traffic to the attacker, packet-capture tools (Wireshark, tcpdump) can reveal plaintext or weakly encrypted authentication data, allowing credential theft — which is what this level obtains.

**Hash harvesting**: searching the target system for known hash values (MD5, SHA-1, SHA-256) to locate corresponding files or processes such as authentication services (`radiusd`, `tac_plus`) or their configuration files for later tampering.

**Brute force**: attempting many password guesses until success. Methods include pure brute force (exhaustive character combinations) and dictionary+rule attacks, which apply transformations to likely password lists.

**RADIUS/TACACS+ protocols**:
- **RADIUS** (Remote Authentication Dial-In User Service): used for network access control (authentication, authorization, accounting)
- **TACACS+**: a Cisco protocol offering finer-grained access control

In large enterprises, carriers, and cloud providers these protocols are less often misused; but smaller organizations, campuses, labs, and legacy devices may still rely on RADIUS/TACACS+ without strong password policies, encrypted transports, or multi-factor authentication.

The story premise here is that a security company implanted a backdoor into Bwiiter but our little malware turns that backdoor against them.

### Solution
1. Use WebScan to enumerate the target
2. Use SQL injection against `vuln-report`
3. Obtain the target IP
4. Perform MITM to capture credentials (e.g. `gugu-admin`)
5. Bypass the firewall to retrieve the password
6. Log in successfully

## Level 4 — Backdoors in Security Companies

### Background
Level 4 does not introduce new attack mechanics but surfaces interesting real-world information.

It is not uncommon for security vendors or other service providers to ship software that contains backdoors or exfiltration capabilities:

- **Hacking Team (2018)**: an Italian spyware vendor was exposed for embedding backdoors in its products and selling surveillance tools to repressive regimes. Leaked emails showed assistance to the Sudanese government, which led to arrests.

- **NetSarang (2021)**: researchers discovered a backdoor module (`nssock2.dll`) in NetSarang’s Xshell/Xmanager SSH clients. The module could collect and upload user and system data, affecting millions of users.

- **SolarWinds Orion supply-chain attack (2020)**: a Russian APT compromised SolarWinds’ build infrastructure and inserted the Sunburst backdoor into legitimate updates for the Orion monitoring product. Over 18,000 customers, including sensitive U.S. agencies, received the compromised update, enabling extensive espionage.

**Supply-chain attack consequences**:
- **Trust erosion**: customers lose faith in software vendors
- **Economic cost**: organizations must invest heavily in audits and remediation
- **Data leakage**: sensitive information can be stolen and later weaponized
- **Regulatory scrutiny**: legal and oversight consequences for affected parties

**Other notable incidents**:
- **Okta library backdoor (2022)**: a support library was found to contain backdoor-like code
- **CCleaner (2017)**: a popular system-cleaning tool was distributed with a backdoor affecting millions
- **Supremo RAT (2015)**: remote-access software discovered with an embedded backdoor used for surveillance

**Ethical concerns around security-vendor backdoors**:
- **Dual use**: surveillance tools can serve legitimate law-enforcement purposes but also be abused
- **Lack of transparency**: users are often unaware of monitoring capabilities
- **National security vs. privacy**: tension between government needs and civil liberties
- **Responsibility**: who is accountable when a vendor-supplied backdoor is abused?

**Mitigations**:
- Prefer open-source software where code can be audited
- Rely on digital signature verification to ensure software integrity
- Isolate critical systems (air-gapping) when appropriate
- Commission third-party audits and assessments
- Apply least-privilege principles to limit software access

### Solution
1. Use WebScan to enumerate the target
2. Use SQL injection to extract `client-data`
3. Perform MITM to discover IP addresses
4. Log in successfully

## Level 5 — IoT Exploitation & Zero-Day Vulnerabilities

### Background
One of the new tools in this level is **IOT-Exploit**, which targets software/hardware defects, misconfigurations, or protocol weaknesses in Internet-of-Things (IoT) devices. Attackers develop or reuse code and scripts to gain unauthorized control, implant backdoors, and pivot laterally (using compromised devices as footholds to access internal networks or cloud services).

Today, billions of devices — cameras, routers, industrial controllers, smart-home devices, and vehicle systems — are deployed on public IPs or reachable behind NAT, often with poor security design (weak default passwords, lack of encryption, etc.).

**IoT security issues**:
- **Default credentials**: many devices ship with `admin/admin`-style defaults
- **Firmware vulnerabilities**: vendors seldom provide timely updates
- **Weak encryption**: outdated ciphers or plaintext communication
- **Exposed services**: unnecessary internet-facing interfaces
- **Supply-chain risks**: third-party components may contain backdoors

**Notable IoT attack cases**:
- **Mirai botnet (2016)**: infected hundreds of thousands of IoT devices (cameras, routers) to launch one of the largest DDoS attacks, impacting services like Twitter and Netflix. Infection relied on brute-forcing weak credentials.
- **VPNFilter (2018)**: malware that backdoored routers to steal data, launch DDoS attacks, and self-destruct; it affected around 500,000 devices worldwide.
- **2020 IoT botnet attacks**: large-scale DDoS using smart-home devices reached peak traffic of 1.5 Tbps.

In the game, an intelligent thermostat is used as a pivot to discover internal domain names and the internal DNS server used for name resolution. If DNS services are modified or replaced, traffic can be redirected, internal services impersonated, or sensitive information leaked.

**DNS spoofing** in the game refers to altering domain name resolution so that users are directed to an incorrect IP address — i.e., they believe they are visiting a legitimate site but are routed to an attacker-controlled server. Two common techniques are:

- **Cache poisoning**: forging DNS responses so that recursive resolvers cache incorrect records and serve them to subsequent queries
- **Man-in-the-middle tampering**: intercepting genuine DNS queries and returning forged responses

**DNSSEC** can mitigate such attacks, but the in-game base has not enabled it. **TTL manipulation** is the practice of modifying or abusing a record’s TTL (time-to-live) — expressed in seconds — to control how long caches retain a poisoned record.

**Gateway**: colloquially a network "door" or relay. In VPN contexts, a VPN gateway authenticates remote users/devices, establishes encrypted tunnels, forwards tunnel traffic, and pushes routing/DNS/policy information to clients.

The game’s **vpn-forge** simulates forging or emulating a VPN gateway or session — essentially creating an entity that appears to be a legitimate VPN endpoint, convincing the client or upstream devices that it is a trusted peer and thereby gaining access to traffic or permissions.

Even **physically air-gapped systems** can be attacked. An attacker that controls a device connected to a management or office network (printer, copier, scanner, desktop, laptop, etc.) can collect network topology, share pathways, reachable hosts, and available peripherals (USB, file shares). They look for ways to write malware to removable media or peripherals (printer storage, USB drives). Those media can then be carried into the air-gapped environment and introduced to isolated systems. If the isolated systems autorun media or lack strong integrity checks, infection becomes possible.

**Do air-gapped devices have IP addresses?** Many so-called "air-gapped" environments are actually "controlled gaps" with dedicated management networks. Devices on those management networks often have IPs for remote maintenance or logging; some isolation workflows temporarily connect isolated machines to IP-enabled devices (e.g., via USB-to-Ethernet bridges). During those maintenance windows the isolated environment is exposed at the network layer.

**Zero-day discovery and exploitation process**:
1. **Discovery**: find software defects via reverse-engineering, fuzzing, or code review
2. **Proof-of-concept (PoC)**: create a PoC to confirm the vulnerability is exploitable
3. **Exploit development**: craft reliable exploit code
4. **Weaponization**: integrate the exploit into malware or attack tooling
5. **Deployment**: execute the attack against target systems

**Famous zero-day examples**:
- **Heartbleed (2014)**: an OpenSSL flaw that allowed reading server memory and leaking sensitive data
- **WannaCry (2017)**: used the EternalBlue SMB zero-day to spread ransomware globally
- **Log4Shell (2021)**: a remote code execution vulnerability in Apache Log4j that affected millions of systems

At the end of the game, a tool called **ZeroDay-Exploit** is used. "Zero-Day" denotes a vulnerability unknown to the vendor or public and without a patch; a Zero-Day Exploit is code that takes advantage of such a flaw.

**Binary analysis** is the static or dynamic investigation of compiled machine code — examining disassembly or decompiled output, control-flow graphs, call graphs, symbols, and strings to understand function interactions. Malware and defensive protections often use anti-debugging techniques to detect debuggers, VMs, or analysis environments and change behavior to evade inspection.

**Buffer overflow**: writing more data to a buffer than it can hold overwrites adjacent memory; if an attacker controls that overwritten data, they can alter program control flow.

**Kernel injection / kernel-mode privilege escalation**: the OS kernel has the highest privileges. If an attacker can execute code in kernel mode or modify kernel data structures, they can bypass most user-mode defenses, install rootkits, hide processes, or escalate privileges. Kernel attacks are more severe and harder to detect and remediate than user-mode attacks.

**Attack vector**: the path or means by which an attacker reaches or compromises a target (network services, malicious attachments, removable media, driver bugs, etc.).

### Solution
1. Use SQL injection
2. Use IoT-Exploit to leverage IoT device vulnerabilities
3. Use DNS-Spoof to manipulate name resolution
4. Use VPN-Forge to fake a VPN gateway
5. Use USB-Infect to spread via removable media
6. Use Zero-Day to exploit an unpatched vulnerability
7. Use Nuke-Control to access the nuclear control system




# 游戏教程

## 第一关 — 钓鱼邮件与网页扫描

### 科普
第一关是一个钓鱼邮箱+网页扫描的关卡，主角病毒要通过骗取Bmail管理员的账户密码来登录到后台中。

**邮箱钓鱼**是指攻击者伪装成受信任的发送者（如同事、合作伙伴、银行等），通过电子邮件诱导收件人点击恶意链接、下载附件或直接输入账号、密码等敏感信息，从而实现信息窃取或植入恶意代码的行为。

常见类型包括：
- **链接钓鱼**：邮件正文中嵌入伪造的URL，诱导用户访问钓鱼站点
- **附件钓鱼**：发送带有恶意宏或可执行文件的附件，打开后会执行恶意代码
- **克隆钓鱼**：复制合法邮件内容并加入恶意元素，利用受害者对原邮件的信任进行欺骗
- **二维码钓鱼**：在邮件或短信中放置伪造的二维码，引导用户扫描后访问钓鱼站点

**实际案例**：2016年的John Podesta钓鱼事件中，攻击者伪装成Google安全团队发送钓鱼邮件，导致民主党主席的邮箱被入侵，影响了美国大选。另一个著名案例是2020年的Twitter比特币骗局，攻击者通过钓鱼获得内部员工访问权限，劫持了多个名人账号发布比特币诈骗信息。

**钓鱼邮件的识别技巧**：
- 检查发件人地址：鼠标悬停查看真实邮箱地址
- 留意紧急语气：如"立即点击""账户将被冻结"等
- 检查URL：鼠标悬停查看链接真实地址
- 避免点击可疑附件：除非确认来源可靠

本游戏第一关演示的案例是链接钓鱼，人们倾向于接受与自己已有认知或兴趣相符的信息。攻击者正是利用这种心理，让受害者在看到"猫咪选美"相关的链接时，快速认同并点击，而不去仔细审查链接的真实性。

第一关屏幕主角的信息可见于浏览记录、回收站中，这里启发我们即使是一些第一时间不可见的地方，很有可能隐藏着一些隐私信息。

**网页扫描**是利用爬虫或专用安全工具对目标站点进行系统化抓取、路径枚举和漏洞检测的过程，常用于发现隐藏的后台管理入口、未授权的API、敏感文件等"后台连接"。

本游戏演示的方法是**目录/文件枚举**：使用字典或暴力方式尝试访问常见的后台路径（如`/admin/`、`/manager/`、`/login.php`等），这是一个很经典的方式，在现实中仍然十分常见，防御措施围绕避免可预测的目录名称、统一错误响应、使用WAF限流等展开。

**防御措施**：
- 使用随机生成的后台路径名
- 实施IP白名单限制
- 配置Web应用防火墙（WAF）
- 定期进行安全扫描和监控

这一关的难点主要在组合Send-Email的信息，OriginalLink指的是要用什么链接作为模板钓鱼，Subject选择目标感兴趣的主题。

### 解法
1. 从回收站的照片中收集邮箱信息
2. 从搜索记录获取猫咪选美相关信息
3. 从链接记录获取`www.bmail.com`信息
4. 使用WebScan扫描获得后台链接
5. 使用Send-Email发送钓鱼邮件获得密码
6. 在后台链接登录

## 第二关 — SQL注入与VPN后门

### 科普
第二关是一个邮箱系统，目录/文件枚举仍然适用于发现后台数据库的HTTP接口，WebScan扫描到对应的数据库。

**SQL注入攻击**是指当Web应用把用户提交的字段直接拼接进SQL语句，而没有进行有效的过滤或预编译时，攻击者可以在这些字段中注入合法的SQL关键字（如`SELECT`、`UNION`、`OR`、`--`等），使数据库执行原本不该执行的语句。

登录表单、搜索框、URL参数、Cookie等任何可控的输入都可以作为注入点。后端代码把输入值直接拼接到查询字符串，例如`SELECT * FROM users WHERE name='${input}'`。攻击者在`${input}`中加入`' OR 1=1--`，导致查询条件始终为真，进而绕过身份验证或返回全部记录。

SQL注入最早的公开记载出现在1998年的《Phrack》第54期，随后在1999年被安全社区广泛关注，成为Web安全史上的里程碑。1999-2005年间，随着PHP+MySQL、ASP+SQL Server的普及，SQL注入迅速成为最常见的漏洞之一。即使在2025年，SQL注入仍是企业渗透测试和漏洞评估的必测项目，全球数十万网站仍因未正确防护而受到攻击。通过参数化查询、严格输入校验、最小权限、错误隐藏四大技术手段，加上渗透测试，能够在现代Web应用中基本消除这一威胁。

**SQL注入的危害等级**：
- **低危**：仅能读取公开数据
- **中危**：可读取敏感数据或修改数据
- **高危**：可执行系统命令或完全控制服务器
- **严重**：可删除数据库或持久性后门植入

本关一样用到了钓鱼，可见第一关的科普，这一关从钓鱼登录改为了注入后门，把后门代码（脚本或二进制）"注入"到用户的浏览器/系统中，随后通过网络回连实现远程控制。

**指纹**是指钓鱼页面会在用户访问时收集浏览器指纹（User-Agent、Canvas、WebGL、字体、插件等），并把这些信息存入数据库，以便后续伪装成目标站点的指纹来骗取登录凭证。

**C2服务器（Command and Control）**：是指攻击者用于控制已感染主机的远程服务器。后门程序会定期连接C2服务器，接收指令并发送窃取的数据。C2服务器可以是：
- 专用服务器：攻击者租用的VPS或云服务器
-  compromised主机：已被控制的合法服务器
- P2P网络：去中心化的控制网络，更难被封锁

已植入的后门常把**VPN隧道**作为C2通道，因为VPN的加密特性可以让恶意流量混入合法流量，难以检测。游戏中的**DPI（深度包检测）**不仅检查报文的头部信息（如IP、端口），还能解析并分析报文的负载（payload），从而识别协议、内容甚至特定的关键字。

**实际案例**：2017年的WannaCry勒索软件使用永恒之蓝漏洞传播，其C2服务器位于朝鲜境内。攻击者通过VPN隧道隐藏通信，造成了全球范围内的大规模感染。

**OpenVPN**是一种开源的VPN实现，支持UDP或TCP传输，提供基于TLS/SSL的强加密（如AES-256-CBC、AES-256-GCM），并支持多种认证方式（证书、用户名/密码、双向TLS）。它可以工作在TUN（路由）或TAP（桥接）模式。

**后门持久化技术**：
- **注册表启动项**：在Windows注册表中添加启动项
- **计划任务**：创建定时执行的任务
- **服务安装**：将后门注册为系统服务
- **内核模块**：植入内核级后门，难以检测和移除

我们注意到，Bmail的系统中明文存储了密码，这是非常危险的，在现实中通常会使用专门的密码哈希函数，配合唯一随机盐（每个用户的盐都不相同，即使两个用户的密码相同，最终的哈希值也会不同），可以理解成对密码进行特殊处理（通过数学算法压缩成固定长度的"指纹"。这个指纹是几乎不可逆的）；除此之外，还有非常多的保障安全的技术，可以查阅网上资料了解。

### 解法
1. 使用WebScan扫描目标
2. 使用SQL-Inject注入获得邮箱记录，包含关键信息
3. 注入后门代码
4. 使用Vpn-Tool建立VPN连接
5. 使用Remote-Connect远程连接到目标系统

## 第三关 — 中间人攻击与防火墙破解

### 科普
第三关从域名变为了IP，注意我们还指定了端口，在现实中需要先探测目标IP上哪些端口开放，确认端口上运行的是Web服务器，扫描工具才能收到相应的HTTP响应。

这一关新出现的**MITM（中间人攻击）**，指的是攻击者在通信双方（通常是客户端↔服务器）之间悄悄插入自己，拦截、篡改或伪造双方的网络数据，而双方却毫不知情，以为自己仍在直接对话。

**MITM攻击的实现方式**：
- **ARP欺骗**：在局域网中伪造ARP响应，欺骗目标主机
- **DNS欺骗**：篡改DNS解析结果，将用户引导到假网站
- **BGP劫持**：在互联网层面劫持路由
- **SSL剥离**：强制降级HTTPS连接为HTTP
- **恶意代理**：诱导用户使用攻击者控制的代理服务器

**ARP欺骗的工作原理**：
ARP（Address Resolution Protocol）用于将IP地址转换为MAC地址。当主机A要与主机B通信时，会发送ARP请求询问"谁有IP B的MAC地址"。攻击者C可以发送伪造的ARP响应，声称自己是B的MAC地址，从而让A把发给B的数据包都发送给自己。

**实际案例**：2018年的Marriott酒店WiFi攻击中，攻击者通过ARP欺骗拦截酒店客人的网络流量，窃取信用卡信息和登录凭证。另一个案例是2019年的Capital One数据泄露，攻击者利用云配置错误和MITM技术窃取了1亿用户的个人信息。

**CVE-XXXX-YYYY**指的是XXXX报告的第YYYY号漏洞，**ARP欺骗**指的是攻击者向局域网内的主机发送伪造的ARP响应，把自己的MAC地址冒充成网关或目标主机的MAC，从而把双方的流量全部经由自己转发。

**MITM攻击的防御方法**：
- 使用HTTPS和HSTS（HTTP严格传输安全）
- 实施ARP监控和检测
- 使用VPN加密通信
- 部署证书固定（Certificate Pinning）
- 定期更新系统和补丁

攻击代码利用**身份验证模块的缓冲区溢出**漏洞，意思是专门针对系统或应用中负责身份验证（如登录、口令校验）的组件，利用该组件的缓冲区溢出（向固定大小的内存缓冲区写入超出范围的数据）来破坏程序执行流。

**缓冲区溢出的原理**：
程序为变量分配固定大小的内存空间，当输入数据超过这个空间时，多余的数据会覆盖相邻的内存区域。如果攻击者精心构造输入数据，就能覆盖函数返回地址、修改变量值，甚至执行任意代码。

由于ARP欺骗把流量全部导向攻击者，攻击者可以使用抓包工具（如Wireshark、tcpdump），解析出明文或经过弱加密的认证信息，进而获取用户的账号密码，本关获取的是账户。

**哈希提取**：指利用已知的哈希值（如MD5、SHA-1、SHA-256）在目标系统中搜索对应的文件或进程。确认位置和进程的目的在于：找到认证服务的可执行文件（如radiusd、tac_plus）或其配置文件，以便后续篡改、植入后门。

**暴力破解**：对认证系统进行大量密码尝试，直至成功登录。常见方式有两种：纯暴力（遍历所有可能的字符组合，计算量极大）和字典+规则（使用密码字典配合规则生成变体）。

**RADIUS/TACACS+协议**：
- **RADIUS**（Remote Authentication Dial-In User Service）：用于网络访问控制，支持认证、授权、计费
- **TACACS+**：Cisco专有的协议，提供更细粒度的访问控制

在现实中，尤其是大型企业、运营商、云服务提供商，已经很少出现这种被破解的情况，但中小企业、校园网、实验室、老旧设备可能仍在使用传统的RADIUS/TACACS+作为唯一的AAA方案，缺乏密码强度要求、加密传输或多因素认证。

本关的故事背景是一个安全公司在Bwiiter植入了后门，但反被我们的小病毒利用。

### 解法
1. 使用WebScan扫描目标
2. 使用SQL注入攻击vuln-report表
3. 获取目标IP地址
4. 使用MITM中间人攻击获得凭据（gugu-admin）
5. 使用防火墙破解获得密码
6. 成功登录系统

## 第四关 — 网络安全公司的后门

### 科普
第四关没有什么新的东西，不过可以找到一些有趣的信息。

在现实中，网络安全公司或者其他网络服务公司在其服务对象上安装后门/窃取数据的事情其实不少见：

- **2018年意大利的Hacking Team事件**：这家专门销售监控软件的公司被曝光在其产品中预留后门，不仅供自家使用，还出售给各国政府用于监控异见人士。泄露的邮件显示他们曾帮助苏丹政府监控反对派，导致多人被捕。

- **2021年NetSarang后门事件**：安全研究者在NetSarang公司的Xshell/Xmanager系列SSH客户端产品中发现nssock2.dll模块被植入后门。该后门能够收集用户信息、系统信息并上传到远程服务器，影响了全球数百万用户。

- **SolarWinds Orion供应链攻击**：2020年，俄罗斯APT组织通过入侵SolarWinds的构建系统，在Orion网络监控软件中植入Sunburst后门。该后门伪装成合法更新分发给18,000多家客户，包括美国财政部、商务部等重要机构，导致大规模间谍活动。

**供应链攻击的影响**：
- **信任破坏**：用户对软件供应商的信任被严重损害
- **经济损失**：企业需要投入大量资源进行安全评估和系统重建
- **数据泄露**：敏感信息可能被窃取用于进一步攻击
- **监管压力**：可能面临法律处罚和监管机构的调查

**其他知名案例**：
- **2022年Okta后门事件**：身份验证服务提供商Okta被发现支持库中存在后门代码
- **2017年CCleaner后门**：知名系统清理工具被植入后门，影响数百万用户
- **2015年Supremo RAT**：远程控制软件被发现内置后门，用于监控用户

**安全公司后门的伦理问题**：
- **双重用途**：监控软件既可用于合法执法，也可被滥用
- **透明度缺失**：用户往往不知情就被监控
- **国家安全vs个人隐私**：政府需求与公民权利的冲突
- **责任归属**：当后门被恶意利用时，谁应该承担责任？

**防御措施**：
- **开源软件优先**：代码可审查，减少隐藏后门风险
- **数字签名验证**：确保软件完整性
- **网络隔离**：重要系统使用空气间隙
- **第三方审计**：定期进行安全评估
- **最小权限原则**：限制软件访问权限

### 解法
1. 使用WebScan扫描目标
2. 使用SQL注入获取client-data表中的信息
3. 使用MITM中间人攻击获取IP地址
4. 成功登录系统

## 第五关 — 物联网利用与零日漏洞

### 科普
本关的新工具之一有**IOT-Exploit（物联网漏洞利用）**，攻击者针对物联网（IoT）设备中的软硬件缺陷、配置错误或协议弱点，编写或使用专门的恶意代码、脚本或工具，以获取未授权的控制权、植入后门、横向渗透（利用已被控制的设备作为跳板，进一步攻击内部网络或云平台）等行为。

在现代，全球已有数十亿台智能摄像头、路由器、工业控制器、智能家居、车载系统等，往往部署在公网IP或NAT后的可达网络段，且常常有安全设计不足的特点（使用弱口令、缺乏加密等）。

**IoT设备的安全问题**：
- **默认密码**：许多设备使用admin/admin等默认凭据
- **固件漏洞**：厂商很少提供安全更新
- **弱加密**：使用过时的加密算法或明文传输
- **网络暴露**：不必要的互联网连接
- **供应链风险**：第三方组件可能存在后门

**实际IoT攻击案例**：
- **2016年Mirai僵尸网络**：感染了数十万台物联网设备（摄像头、路由器），发动史上最大的DDoS攻击，影响了Twitter、Netflix等网站。攻击者通过弱密码暴力破解获得控制权。
- **2018年VPNFilter恶意软件**：针对路由器植入后门，能够窃取数据、发动DDoS，并具备自我销毁功能。影响了全球50万台设备。
- **2020年物联网僵尸网络攻击**：利用智能家居设备发动大规模DDoS，峰值流量达1.5Tbps。

在游戏中，使用智能温控器作为跳板，获取到了内部域名和内网中用于解析域名的DNS服务器地址（DNS在内网中负责把域名（例如base-internal.mil）解析成IP地址。若DNS服务被篡改或替换，可能导致流量被重定向、内网服务被冒充或敏感信息泄露）。

游戏中的**DNS Spoof（DNS欺骗）**指的是DNS欺骗，攻击者通过篡改域名解析结果，让用户访问错误的IP地址。换句话说：你以为自己访问的是这个网址，但由于解析被篡改，实际上被引导到了攻击者伪造的网站。常见的两种实现途径：

- **缓存投毒（DNS Cache Poisoning）**：伪造DNS响应，使递归DNS缓存错误的记录，从而影响所有后续查询
- **中间人篡改（Man-in-the-Middle）**：攻击者拦截真实查询流量，并返回伪造的响应

**DNSSEC**可用于防范这种攻击，但游戏中的基地没有启用。**TTL操纵**是人为修改或滥用TTL值，TTL是DNS记录的"生存时间"，以秒为单位，告诉缓存服务器该条记录可以保存多久。

**网关**：通俗说就是网络之间的"门"或"中转站"。在VPN场景下，VPN网关负责：验证远端用户/设备；建立加密隧道；转发隧道内外的流量；下发路由、DNS、策略等给客户端。

游戏中**vpn-forge**工具指的是伪造/模拟VPN网关或VPN会话的技术或工具——本质上是"制造一个看起来像合法VPN网关或合法隧道终端"的实体，使得目标客户端或上游设备相信它是受信任的一端，从而把流量或访问权限交给攻击者。

即使是**物理隔离的设备（air-gap）**也可能被攻击，攻击者先取得某个与管理网络或办公网络相连的设备控制权（例如打印机、复印机、扫描仪、桌面、笔记本等）。这些设备本身经常被忽视且安全防护薄弱，在被控制的设备上搜集网络拓扑、共享路径、可达主机信息和可用外设（USB、文件共享等），并寻找能够把恶意负载写到外部媒体或外设的机会，利用对打印机/多功能设备的控制，诱导或直接把恶意文件/固件/镜像写入到USB设备、打印机存储或其它可移除媒介。这些媒介随后可能被带到物理隔离的环境，恶意USB或光盘被插入到本该物理隔离的系统上，从而把恶意负载带入被隔离网络。若隔离系统存在可执行自动加载或缺乏强校验流程，则有被感染的风险。

**物理隔离的设备也有IP地址？**许多所谓的"物理隔离"其实是"受控隔离"或有专门管理网络。这类设备可能在单独管理网段上有IP地址，用于远程维护或日志上报，某些隔离设备在维护或数据传输时会临时连接到有IP的设备（例如通过USB-to-Ethernet中转）。在这些时刻，隔离环境就"暴露"了网络层面的地址性。

**零日漏洞的发现和利用过程**：
1. **漏洞发现**：通过逆向工程、模糊测试、代码审计等方式发现软件缺陷
2. **漏洞验证**：编写PoC（Proof of Concept）验证漏洞可利用性
3. **利用开发**：开发可靠的exploit代码
4. **武器化**：将exploit集成到恶意软件或攻击工具中
5. **部署利用**：针对目标系统发动攻击

**著名零日漏洞案例**：
- **Heartbleed (2014)**：OpenSSL心脏出血漏洞，允许攻击者读取服务器内存中的敏感数据
- **WannaCry (2017)**：利用Windows SMB协议的永恒之蓝零日漏洞，造成全球性勒索软件攻击
- **Log4Shell (2021)**：Apache Log4j远程代码执行漏洞，影响全球数百万系统

游戏最后，使用了一个叫**ZeroDay-Exploit**的工具，"Zero-Day"通常指厂商或公众尚未知晓、尚无补丁的漏洞；Zero-Day Exploit则是利用该漏洞的实际攻击代码或方法。名称来自于"从被发现到被利用之前的时间为零天"。

**二进制分析**是对编译后机器码的静态或动态研究，查看反汇编/反编译结果、控制流图、调用图、符号和字符串等，理解各函数如何交互。很多恶意软件或保护机制使用"反调试"技术来检测是否在调试器、虚拟机或分析环境中运行，从而改变行为或拒绝执行以规避分析。

**缓冲区溢出**：程序把超出目标缓冲区容量的数据写入内存时，会覆盖相邻内存。如果攻击者能控制被覆盖的数据，可能改变程序控制流。

**注入内核/内核模式提权**：操作系统内核拥有最高权限，一旦攻击者能在内核级别执行代码或修改内核数据结构，他们就能绕过多数用户态防护，安装rootkit、隐藏进程或提升权限。内核攻击通常比用户态攻击更严重且更难检测与修复。内核模式提权指通过利用内核缺陷让用户态进程获得内核或系统管理员级别的权限。

**攻击向量**：攻击者达到目标或执行攻击的路径或手段（例如网络服务漏洞、恶意附件、物理媒介、驱动程序缺陷等）。

### 解法
1. 使用SQL注入攻击
2. 使用IoT-Exploit利用物联网设备漏洞
3. 使用DNS-Spoof进行DNS欺骗
4. 使用VPN-Forge伪造VPN网关
5. 使用USB-Infect通过USB设备感染目标
6. 使用Zero-Day利用零日漏洞
7. 使用Nuke-Control控制核武器系统